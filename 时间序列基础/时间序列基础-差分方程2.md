## 第二章 高阶差分方程

> 从欣赏的角度学习（结果漂亮，推导完整）

考虑n阶齐次方程
$$
y_t - \sum_{i=1}^{n}a_iy_{t-i} = 0
$$
假设每一个齐次解具有形式$y_t^k = Aa^t$ ，其中A为任意常数，带入上面的式子可以得到
$$
Aa^t - \sum_{i=1}^{n}a_iAa^{t-i}，两边除以Aa^{t-n}\\
a^n - a_1a^{n-1}-a_2a^{n-2} - ... - a_n = 0
$$
n阶多项式有n个根，记这n个特征根分别为$a_1,a_2,a_3,...,a_n$，$a_t$ 可以为实数或复数，复数根则成对出现，相互共轭。稳定性条件要求除了为1的单特征根（对应常数解），其他特征根的绝对值都小于1或在单位圆之内；否则解将发散。

###2.1 高阶齐次解的表达形式 

1. 所有特征根都是相异实根，此时解的表达式为
   $$
   y_t^h = A_1a_1^t + A_2a_2^t + ... + A_na_n^t
   $$
   其中$A_1~A_n$为任意常数，给定n个初始条件就可以求出它们的具体值

2. 所有特征根都是实根，但有m（小于等于n）个重根，设重根为$a_1=a_2=...=a_m$，则有m个重根产生的解为
   $$
   A_1a_1^t + A_2ta_1^t + ... + A_mt^{m-1}a_m^t
   $$
   其中$A_1~A_m$为任意常数。假设互不相同 的特征根有s个，则齐次方程的通解就等于则s个不同特征根所产生的解之和，其中包含有n个参数。给定n个初始条件，就可以确定则n个参数的具体值。

3. 一些特征根为复根，此时它们共轭出现，记一对共轭根为$a \pm i \theta$ ，则有这对共轭根所产生的解为
   $$
   A(a+i \theta)^t +A_2(a - i \theta)^t
   $$
   其中$A_1,A_2$为任意常数，转换为极坐标，可写成 
   $$
   \beta_1 r^t cos(\theta t + \beta_2)，其中\beta_1,\beta_2为任意常数
   $$
   于是齐次差分方程的通解就等于所有不同实根或复特征根所产生的解之和；其中含有n个参数。给定n个初始条件，就可以确定则n个参数的具体取值。

**稳定性条件** 

稳定性判别条件，注意到$\sum_{i=1}^{n}a_i = 1 - (1 - a_1)...(1 - a_n)$ ，则可以证明

- 所有特征根都位于单位圆内的必要条件为$\sum_{i=1}^{n}a_i \lt 1$ 

- 所有特征根都位于单位圆内的充分条件为$\sum_{i=1}^{n}|a_i| \lt 1$ 

- 若$\sum_{i=1}^{n}a_i = 1$ ，则至少有一个特征根等于1，包含一个或多个等于1的特征根序列称为`单位根序列`。此时，n阶差分方程的解可能发散或不稳定；

- 对于三阶方程，稳定条件可以写为
  $$
  1-a_1-a_2-a_3 \gt 0 \\
  1+a_1-a_2+a_3 \gt 0 \\
  1-a_1a_3+a_2-a_3^2 \gt 0 \\
  3+a_1+a_2-3a_3 \gt 0 \ 或 \ 3-a_1+a_2+3a_3 \gt 0
  $$





###2.2 求解确定性过程的特解 

本文介绍推动过程$\{x_t\}$ 为确定项的求解方法

1. $x_t = 0$ 

   此时，差分方程为
   $$
   y_t = a_0 + a_1y_{t-1} + a_2y_{t-2} + ... + a_ny_{t-n}
   $$
   令解的形式为常数$y_t = c$，带入上式可以得到
   $$
   c = \frac{a_0}{1- a_1 - a_2 - ... - a_n}，(1- a_1 - a_2 - ... - a_n) \ne 0
   $$
   若$(1- a_1 - a_2 - ... - a_n)= 0$ 则${y_t}$ 是一个`单位根序列`，其齐次解已包含常数解，此时，除非$a_0=0$ 否则常数解就无效，而应该考虑线性特解$y_t^p=ct$ 把其带入差分方程可以得到
   $$
   c = \frac{a_0}{a_1+2a_2+...+na_n}，(a_1+2a_2+...+na_n) \ne 0
   $$
   若$a_1+2a_2+...+na_n = 0 $ ，则继续尝试使用$y_t^p = ct^2, ct^3,...,ct^n$ 作为解，对于n阶方程，这些解总会有一个会是特解。

2. 对于$x_t=bd^{rt}$ ，其中b，d和r都为常数，r为增长率，此时，差分方程的形式为
   $$
   y_t = a_0 + a_1y_{t-1} + .... + a_ny_{t-n} + bd^{rt}
   $$
   考虑一阶方程$y_t = a_0 + a_1y_{t-1} + bd^{rt}$ ，令解形式为$y_t^p = c_0 + c_1d^{rt} $，其中$c_0,c_1$为待定常数，带入差分方程可得
   $$
   c_0 + c_1d^{rt} = a_0 + a_1[c_0 + c_d^{r(t-1)}] + bd^{rt}
   $$
   使两队对应相等，取
   $$
   c_0 = \frac{a_0}{1-a_1}，c_1 = \frac{bd{r}}{dr-a_1}
   $$
   因此特解为
   $$
   y_t^p =  \frac{a_0}{1-a_1} +  \frac{bd{r}}{dr-a_1}d^{rt}
   $$
   当$|d^r| \lt 1$ 时，该特解将收敛于$\frac{a_0}{1-a_1}$ ，若分母为零即$a_1=1或a_1=d^r$ ，则使用1中技巧求解，例如：

   当$a_1=1$ ，尝试使用$y_t^h = ct + c_1d^{rt}$ ,带入差分方程求解c和c1带入就可求得特解。同理当$a_1=d^r$ 时，令$y_t^h=c_0 t +c_1 t d^{rt}$ 带入差分方程求解c和c1。对于高阶方程同样使用类似方法求解。

3.  $x=bt^d$ 幂函数，其中b，d为正常数
   $$
   y_t = a_0 + a_1y_{t-1} + .... + a_ny_{t-n} + bd^{rt} 
   $$
   其解的一般形式为
   $$
   y_t^p=c_0 + c_1t + c_2t^2 + ... + c_dt^d
   $$

   例子：$y_t = a_0 + a_1 y_{t-1} +a_2 y_{t-2} + bt$ ，其中d=1

   猜想二阶差分方程的特解形式为$y_t^p = c_0 + c_1 t$ ，带入差分方程整理得
   $$
   c_0 = \frac{a_0 - (2a_2 +a_1)}{1 - a_1 - a_2} \\
   c_1 = \frac{b}{1- a_1 - a_2}
   $$
   当$a_1 + a_2 = 1$ 时，令特解为$y_t^p = c_0 t+ c_1t^2$ ，带入求解，依次类推。

###2.3 求随机性过程的特定系数法 

本文介绍推动过程为随机项（干扰项）求特解的待定系数法，因这种特定系数法可能无解，所以称他为`挑战解`。求解思路如下，由浅入深。

1. 只带一个随机项的一阶差分方程
   $$
   y_t=a_0+a_1y_t+\epsilon_t
   $$
   猜想挑战解为
   $$
   y_t = b_0 + b_1t + \sum_{i-0}^{\propto}a_i \epsilon_{t-i}
   $$
   其中$b_0,b_1,a_i$均为待定系数，带入差分方程求解
   $$
   b_0 + b_1t + \sum_{i-0}^{\propto}a_i \epsilon_{t-i} \\
   = a_0 + a_1( b_0 + b_1(t-1) + \sum_{i-0}^{\propto}a_i \epsilon_{t-1-i}) + \epsilon_{t-1}
   $$
   对于t上述都成立，因此常数项和系数都为零。求得
   $$
   b_0 - a_0 - a_1 b_0 + a_1 b_1 = 0 \\
   b_1(1- a_1) = 0
   $$
   当$a_1 \ne 1$ 时，则$b_1=0，b_0 = \frac{a_0}{1 - a_1}$ ，当$|a_1| \lt 1$ 时，此时特解为
   $$
   y_t^p = \frac{a_0}{1 - a_1} + \sum_{i=0}^{\infty} a_1^i \epsilon_{t-i}
   $$
   当$a_1 = 1$ 时，则$b_1=a_0，b_0任意 $ ，此时特解为
   $$
   y_t^p = b_0 +a_0 t + \sum_{i=0}^{\infty} \epsilon_{t-i}
   $$

2. 带两个随机项的一阶差分方程 
   $$
   y_t = a_0 + a_1y_{t-1} + a_2 y_{t-2} + \epsilon_{t}
   $$
   猜想挑战解为
   $$
   y_t = b_0 + b_1 t + b_2 t^2 + \sum_{i=0}^{\infty} a_i \epsilon_{t-i}
   $$
   
   ​

3. 高阶方程，挑战解的一般式为
   $$
   y_t = b_0 + b_1 t + b_2 t^2 + b_3 t^3 + ... + b_n + t^n + \sum_{i=0}^{\infty}a_i \epsilon_{t-i}
   $$


###2.4 滞后算子 

运用滞算子，表达式上比特定系数灵活；滞后算子定义为
$$
L^iy^t=y_{t-i}
$$

滞后算子的性质如下

1. 常数的滞后算子为常数：$Lc=c$

2. 分配律也适合滞后算子
   $$
   (L^i+L^j)y_t - L^iy_t + L^jy_t =y_{t-i} + y_{t-j}
   $$

3. 结合律也适用于滞后算子
   $$
   L^iL^jy_t = L^j(L^iy_t)=y_{t-i-j}
   $$

4. L取负次方时，实际上为`超前算子`，即$L^{-i}y_t=y_{t+i}$

5. 当|a|<1时
   $$
   (a+aL+a^2L^2+...)y_t=\frac{y_t}{1-aL}
   $$

6. 当|a| > 1时
   $$
   \frac{y_t}{1-aL}=-(aL)^{-1}\sum_{i=0}^{\propto}(aL)^{-i}y_t 
   $$

7. 利用滞后算子，可将P阶差分方程
  $$
  y_t=a_0 + a_1y_{t-1}+...+a_py_{t-p} + \epsilon_t
  $$
  表示为
  $$
  (1-a_1L-a_2L^2+ ... + a_pL^p)y_t = a_0+\epsilon_t \\
  记做： A(L)y_t=a_0+\epsilon_t \\
  其中A(L)=1-a_1L-a_2L^2+ ... + a_pL^p \\
  $$
  当 $1-a_1L-a_2L^2+ ... + a_pL^p = 0$ 称为`反比特征方程` ，它的特征根是特征方程的特征根的倒数，所有许多文献称`稳定性条件为特征大根于1，指的就是这个方程的特征根`。

8. 差分方程
   $$
   y_t=a_0 + a_1y_{t-1}+...+a_py_{t-p} + \epsilon_t + \beta_1 \epsilon_{t-1} + ... + \beta_q \epsilon_{t-q}
   $$


   可以表示为
   $$
   A(L)y_t = a_0 + B(L) \epsilon_t  \\
   其中B(L) = 1 - \beta_1 - \beta_2 L^2 - ... - \beta_1 L^q
   $$


####2.4.1 用滞后算子解差分方程

考虑一阶差分方程
$$
y_t=a_0+a_1y_{t-1}+\epsilon_t，其中|a| \lt 1
$$

利用滞后算子L，差分方程表示为
$$
y_t =a_0 -a_1Ly_t + \epsilon_t
$$
解得
$$
 y_t = \frac{a_0 + \epsilon_t}{1 - a_1L}
$$
因为$La_0 = a_0$，所以根据几何级数 
$$
\frac{a_0 }{1 - a_1L}  = (1 + a_1L +a2_1L2 + a3_1L3 + ...)a_0  \\
= a_0 + a_0a_1 + a1^2a_0 + a^3_1a_0 + ... \\ 
= \frac{a_0}{1-a_1}
$$
因为$L^i \epsilon_t = \epsilon_{t-i}$，所以根据几何级数
$$
\frac{\epsilon_t }{1 - a_1L}  = (1 + a_1L +a2_1L2 + a3_1L3 + ...)\epsilon_t  = \epsilon_t  + a_1\epsilon_t +...
$$
联合上述两个式子，则可以得到：
$$
y_t =\frac{a_0}{1-a_1} + \sum_{i=0}^{\infty}a_1^i \epsilon_{t-i}
$$
考虑一阶差分方程
$$
y_t=a_0+a_1t_{t-1}+\epsilon_t，其中|a| \gt 1
$$
此时$y_t$实际上是发散的，利用性质6
$$
y_t=\frac{(a_0+\epsilon_t)}{(1-a_1L)} = {\frac{-(a_1L)^{-1}}{1-(a_1L)^{-1}}}(a_0+\epsilon_t) = -\sum_{i=1}^{\propto}a_1^{-i}L^{-i}(a_0+\epsilon_t) \\
= -\sum_{i=1}^{\propto}a_1^{-i}a_0-\sum_{i=1}^{\propto}a_1^{-i}\epsilon_{t+i} \\
= \frac{a_0}{1-a_1} - \frac{1}{a_1}\sum_{i=1}^{\propto}a_1^{-i}\epsilon_{t+1+i} \\
$$

这里只是形式上的解，实际上式子是没有意义的，因为$y_t$的值取决于未来的，显然不正确。

**高阶方程中的滞后算子** 

n阶差分方程
$$
y_t = a_0 + a_1y_{t-1}+ a_2y_{t-2} + ... + + a_ny_{t-n} + \epsilon_t
$$


可以表示为
$$
(1-a_1L - a_2L^2 - ... - a_nL^n)y_t = a_0 + \epsilon_t
$$
例如二阶方程可以表示为
$$
y_t = a_0 + a_1y_{t-1}+ a_2y_{t-2} + \epsilon_t \\
y_t = \frac{(a_0 + \epsilon_t)}{1 - a_1L - a_2L^2} = \frac{a_0 + \epsilon_t}{(1-b_1L)(1-b_2L)}\\ 其中b1，b2为1 - a_1L - a_2L^2的两个根
$$
当b1，b2的绝对值均小于1时，可以求得
$$
y_t= \frac{a_0/(1-b_1)+\sum_{i=0}^{\infty}b_1^i \epsilon_{t-i}}{1-b_2L}  
= \frac{a_0}{(1-b_1)(1-b_2)} + \sum_{i=0}^{\infty} \sum_{j=0}^{\infty}b_1^i b_2^j \epsilon_{t-i-j} \\
=  \frac{a_0}{(1-a_1 - a_2)}+ \sum_{i=0}^{\infty} \sum_{j=0}^{\infty}b_1^i b_2^j \epsilon_{t-i-j} \\
=  \frac{a_0}{(1-a_1 - a_2)}+ \sum_{k=0}^{\infty} \sum_{i+j=0}^{\infty}b_1^i b_2^j \epsilon_{t-k}
$$
差分方程的算子表示的一般模型
$$
A(L)y_t=a_0 + B(L)\epsilon_t
$$
对于高阶方程采用类似方式计算。

> 实际问题都可以用线性解决，非线性问题可以通过线性进行逼近。最多只到二阶。