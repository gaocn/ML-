##第5章 非平稳时间序列建模

对于不平稳的时间序列有两种分析方法

1. 时间序列确定性分析；
2. 时间序列随机分析，ARMA模型属于时间序列随机分析的一部分。

###5.1 时间序列分解

**Cramer分解定理** ：任何一个时间序列$\{y_t\}$ 都可以分解为两个部分，一部分是由多项式决定的确定性趋势成分，另一部分是平稳的零均值误差成分，即
$$
y_t = \mu_t + \epsilon_t \\
确定趋势\mu_t = \sum_{j=0}^{d} \beta_j t^j \\
随机项 \epsilon_t = \varphi(L)a_t
$$
其中$d < \infty，\beta_1,\beta_2,...,\beta_d$ 为常数系数，$\{a_t\}$ 为一个零均值白噪声序列，L为延迟算子，且满足
$$
E(\epsilon_t) = E(\varphi(L)a_t) = \varphi(L)E(a_t) = 0 \\
E(y_t) = E(\mu_t) = E(\sum_{j=0}^{d} \beta_j t^j) = \sum_{j=0}^{d}\beta_j t^j
$$
**确定性因素分解**

时间序列分析中的因素主要有

1. 长期趋势变动；
2. 循环变动，若循环变动有固定周期则将其归纳到季节性变动中；若循环变动没有固定周期将其归纳到长期趋势中；
3. 季节性变动；
4. 随机波动，除了上述变动的其他所有随机因素构成的变动；

因此在确定性分析中，将序列分解为三大因素

1. 长期趋势（包括长期趋势和无固定周期循环波动）；
2. 季节性变化（包括季节变化和稳定周期的循环波动）；
3. 随机波动；

确定性时间序列分析的目的就是：

1. 克服其他因素影响，单纯测量某个确定性因素对时间序列的影响;
2. 推断确定性因素之间的相互作用，以及其对时间序列的综合影响；

**确定性时间序列分析方法** 

1. 平滑预测法
2. 趋势预测法
3. 分解分析法

###5.2 长期趋势分析与预测

用于长期趋势分析与预测的方法主要由平滑法和趋势拟合法。其中平滑法分为三大类：`移动平滑法`，`加权移动平滑法`，`指数平滑法`。因为每一种方法都是要消除由于时间序列不规则成分所引起的随机波动，所以被称为**平滑法** 。平滑法适用于时间序列在一定的时间内取值比较稳定，序列之间的差异主要是随机波动所引起的，这个时候就可以使用平滑法。

当时间序列可能呈现长期趋势且不能使用平滑法通过均值拟合时，需要采用**趋势拟合法** 找到均值和时间的线性关系，常用的趋势拟合法有：`线性拟合`、`曲线拟合`。

####5.2.1 平滑法

`移动平均法`是一种简单平滑预测技术，其基本思想是根据时间序列资料、逐项推移，依次计算包含一定项数的时序平均值，以反映长期趋势。 

**1. 简单移动平滑SMA** 

计算公式为
$$
\hat{y_{t+1}} = \frac{y_t + y_{t-1} + ... ++ y_{1}}{t}
$$
`代码实现` 



**2. 加权移动平滑WMA** 







**3. 指数加权移动平滑EWMA** 



####5.2.2 趋势拟合法

